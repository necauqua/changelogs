name: Render Changelog
author: necauqua
description: Renders the extracted changelog JSON into markdown
inputs:
  changelog:
    description: Input changelog JSON
    default: changelog.json
  tag-format:
    description: Format of the release header
    default: '[[[{tag}](https://github.com/${{ github.repository }}/tree/{tag})]] {timestamp}'
  date-format:
    description: Format of the date used in tag format
    default: '%F'
  issue-format:
    description: If non-empty, replaces all occurences of `#<number>` with a link with given format
    default: 'https://github.com/${{ github.repository }}/issues/{number}'
  unreleased-header:
    description: Unreleased header string
    default: Unreleased ([{short_hash}](https://github.com/${{ github.repository }}/tree/{hash}))
  filename:
    description: Resulting markdown file name
    default: changelog.md
  only-last:
    description: Set to true to only write the last changelog (unreleased or last release if unreleased is empty) without a header. Ignores the template and header settings
    default: "false"
  template:
    description: Changelog template file
runs:
  using: docker
  image: docker://ghcr.io/necauqua/changelogs@sha256:d82b558f7b97f1755ff6c86372f313cc552edcc44512c262d5a9d7228716abc4
  args:
    - render
    - ${{ inputs.changelog }}
    - ${{ inputs.tag-format }}
    - ${{ inputs.date-format }}
    - ${{ inputs.issue-format }}
    - ${{ inputs.unreleased-header }}
    - ${{ inputs.filename }}
    - ${{ inputs.only-last }}
    - ${{ inputs.template }}

